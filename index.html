<!DOCTYPE html> 
<html> 
<head> <title>The LOCO-I Standard (ISO/IEC 14495-1)</title> 
<meta charset="UTF-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<link rel="stylesheet" type="text/css" href="index.css" /> 
<script type="text/javascript" 
src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" 
></script> 
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead">The LOCO-I Standard (ISO/IEC 14495-1)</h2>
 <div class="author" ><span 
class="ecrm-1200">Vicente Gonz</span><span 
class="ecrm-1200">√°</span><span 
class="ecrm-1200">lez Ruiz</span></div><br />
<div class="date" ><span 
class="ecrm-1200">June 2, 2018</span></div>
   </div>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   <span class="sectionToc" >1 <a 
href="#x1-30001" id="QQ2-1-3">Encoder</a></span>
<br />   <span class="sectionToc" >2 <a 
href="#x1-40002" id="QQ2-1-4">Decoder</a></span>
<br />   <span class="sectionToc" >3 <a 
href="#x1-50003" id="QQ2-1-5">The RLE mode</a></span>
   </div>
<!--l. 6--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-2000"></a>Intro</h3>
     <ul class="itemize1">
     <li class="itemize">LOCO-I¬†<span class="cite">[<span 
class="ecbx-1000">?</span>]</span> (<span 
class="ecsl-1000">LOw COmplexity, context-based, lossless Image compression</span>
     <span 
class="ecsl-1000">algorithm</span>), also named JPEG-LS (Joint Photographic Expert Group -
     LosslesS), is a lossless stil image codec based on context-based predictive
     coding and Golomb Coding.
     </li>
     <li class="itemize">Developed   by   HP,   that   only   oÔ¨Äers   the   executable   code   in:
     <span 
class="ectt-1000">http://www.hpl.hp.com/loco/locodown.htm</span></li></ul>
                                                                  

                                                                  
<!--l. 16--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-30001"></a>Encoder</h3>
<!--l. 17--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-3002x1"><span 
class="ecbx-1000">Initialization of the prediction contexts</span>:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-3004x1">Let <!--l. 20--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Q</mi></math>
         the actual context (there are <!--l. 20--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mn>0</mn><mn>9</mn><mn>4</mn></math>
         diÔ¨Äerent spatial contexts).
         </li>
         <li 
  class="enumerate" id="x1-3006x2">Let <!--l. 22--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
         the number of times that the context <!--l. 22--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Q</mi></math>
         has been found.
         </li>
         <li 
  class="enumerate" id="x1-3008x3">Let <!--l. 24--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
         the accumulated prediction error for the context <!--l. 25--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Q</mi></math>.
         </li>
         <li 
  class="enumerate" id="x1-3010x4">Let <!--l. 26--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></math>
         the sumatory of the absolute value of the prediction residues for the
         context <!--l. 27--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Q</mi></math>.
         </li>
         <li 
  class="enumerate" id="x1-3012x5">Let <!--l. 28--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
         the the bias cancellation values for the context <!--l. 29--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Q</mi></math>.
         These values are added to the predictions to try that the predictions
         residues have a zero average. If this is not satisÔ¨Åed, the compression
         ratio in reduced severelly because the average of the real Lapace
         probability distribution of the residues and the modeled probability
         distribution does not match. For this reason, <!--l. 34--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
         is proportional to <!--l. 34--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-bin">‚àï</mo><mi 
>N</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
         that added to the predictions, cancel the bias.
         </li></ol>
     </li>
     <li 
  class="enumerate" id="x1-3014x2"><span 
class="ecbx-1000">Determination of the prediction context</span>
     <!--l. 42--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">ùí¨</mi></math>:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-3016x1">Compute the local gradient:
         <!--l. 46--><p class="noindent" > <div style="text-align:center;"> <img height=100 src="data/LOCO-I_contexto_prediccion.png" /> </div> 
</p>
                                                                  

                                                                  
<div class="par-math-display"><!--l. 48--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
 <mtable  align="axis" style=""  
equalrows="false" columnlines="none none" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="right">  <msub><mrow 
><mi 
>g</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
>  </mtd><mtd 
class="array"  columnalign="center">  <mo 
class="MathClass-rel">‚Üê</mo> </mtd><mtd 
class="array"  columnalign="left"> <mi 
>d</mi> <mo 
class="MathClass-bin">‚àí</mo> <mi 
>a</mi> </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="right">  <msub><mrow 
><mi 
>g</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
>  </mtd><mtd 
class="array"  columnalign="center">  <mo 
class="MathClass-rel">‚Üê</mo> </mtd><mtd 
class="array"  columnalign="left"> <mi 
>a</mi> <mo 
class="MathClass-bin">‚àí</mo> <mi 
>c</mi> </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="right">  <msub><mrow 
><mi 
>g</mi></mrow><mrow 
><mn>3</mn></mrow></msub 
>  </mtd><mtd 
class="array"  columnalign="center">  <mo 
class="MathClass-rel">‚Üê</mo> </mtd><mtd 
class="array"  columnalign="left"> <mi 
>c</mi> <mo 
class="MathClass-bin">‚àí</mo> <mi 
>b</mi>  </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="right">  <msub><mrow 
><mi 
>g</mi></mrow><mrow 
><mn>4</mn></mrow></msub 
>  </mtd><mtd 
class="array"  columnalign="center">  <mo 
class="MathClass-rel">‚Üê</mo> </mtd><mtd 
class="array"  columnalign="left"> <mi 
>b</mi> <mo 
class="MathClass-bin">‚àí</mo> <mi 
>e</mi>  </mtd></mtr><!--rcl--></mtable>
</mrow></math></div>
         <!--l. 55--><p class="nopar" >
         </p></li>
         <li 
  class="enumerate" id="x1-3018x2">Quantize the gradients:
<div class="math-display"><!--l. 57--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
><msub><mrow 
>
<mi 
>q</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">‚Üê</mo> <mfenced separators="" 
open="{"  close="" ><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="left"> <mn>0</mn> </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if¬†</mtext></mstyle><msub><mrow 
><mi 
>g</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>0</mn>          </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left">  <mn>1</mn>  </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if¬†</mtext></mstyle><mn>1</mn> <mo 
class="MathClass-rel">‚â§</mo><mo 
class="MathClass-rel">|</mo><msub><mrow 
><mi 
>g</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-rel">‚â§</mo> <mn>2</mn>   </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left">  <mn>2</mn>  </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if¬†</mtext></mstyle><mn>3</mn> <mo 
class="MathClass-rel">‚â§</mo><mo 
class="MathClass-rel">|</mo><msub><mrow 
><mi 
>g</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-rel">‚â§</mo> <mn>6</mn>   </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left">  <mn>3</mn>  </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if¬†</mtext></mstyle><mn>7</mn> <mo 
class="MathClass-rel">‚â§</mo><mo 
class="MathClass-rel">|</mo><msub><mrow 
><mi 
>g</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-rel">‚â§</mo> <mn>1</mn><mn>4</mn> </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left">  <mn>4</mn>  </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >otherwise</mtext></mstyle>         </mtd></mtr><!--ll--></mtable>                                                                            </mrow></mfenced>
</mrow></math></div>
         <!--l. 67--><p class="nopar" >
         for <!--l. 68--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn><mo 
class="MathClass-punc">,</mo><mn>3</mn></math>
         and
</p>
                                                                  

                                                                  
<div class="math-display"><!--l. 69--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
><msub><mrow 
>
<mi 
>q</mi></mrow><mrow 
><mn>4</mn></mrow></msub 
> <mo 
class="MathClass-rel">‚Üê</mo> <mfenced separators="" 
open="{"  close="" ><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="left"> <mn>0</mn> </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if¬†</mtext></mstyle><mo 
class="MathClass-rel">|</mo><msub><mrow 
><mi 
>g</mi></mrow><mrow 
><mn>4</mn></mrow></msub 
><mo 
class="MathClass-rel">|</mo> <mo 
class="MathClass-rel">&#x003C;</mo> <mn>0</mn>  </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left">  <mn>1</mn>  </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if¬†</mtext></mstyle><mn>5</mn> <mo 
class="MathClass-rel">‚â§</mo> <msub><mrow 
><mi 
>g</mi></mrow><mrow 
><mn>4</mn></mrow></msub 
>    </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left">  <mn>2</mn>  </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >otherwise</mtext></mstyle><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--ll--></mtable>                                                                     </mrow></mfenced>
</mrow></math></div>
         <!--l. 77--><p class="nopar" >
         </p></li></ol>
     </li>
     <li 
  class="enumerate" id="x1-3020x3"><span 
class="ecbx-1000">Compute the residue </span><!--l. 80--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>e</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-3022x1">The initial prediction:
<div class="math-display"><!--l. 83--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
<mi 
>≈ù</mi> <mo 
class="MathClass-rel">‚Üê</mo> <mfenced separators="" 
open="{"  close="" ><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="left"> <mstyle 
class="text"><mtext  >min</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">,</mo><mi 
>b</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if¬†</mtext></mstyle><mi 
>c</mi> <mo 
class="MathClass-rel">‚â•</mo><mstyle 
class="text"><mtext  >max</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">,</mo><mi 
>b</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >max</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">,</mo><mi 
>b</mi></mrow><mo 
class="MathClass-close">)</mo></mrow>  </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if¬†</mtext></mstyle><mi 
>c</mi> <mo 
class="MathClass-rel">‚â§</mo><mstyle 
class="text"><mtext  >min</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">,</mo><mi 
>b</mi></mrow><mo 
class="MathClass-close">)</mo></mrow>  </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left">  <mi 
>a</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>b</mi> <mo 
class="MathClass-bin">‚àí</mo> <mi 
>c</mi>  </mtd><mtd 
class="array"  columnalign="left"> <mstyle 
class="text"><mtext  >otherwise</mtext></mstyle><mo 
class="MathClass-punc">.</mo>       </mtd></mtr><!--ll--></mtable>                                                       </mrow></mfenced>
</mrow></math></div>
         <!--l. 91--><p class="nopar" >
         </p></li>
         <li 
  class="enumerate" id="x1-3024x2"><span 
class="ecsl-1000">Bias </span>cancellation:
                                                                  

                                                                  
<div class="math-display"><!--l. 94--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
<mi 
>≈ù</mi> <mo 
class="MathClass-rel">‚Üê</mo> <mfenced separators="" 
open="{"  close="" ><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="left"> <mi 
>≈ù</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if¬†</mtext></mstyle><msub><mrow 
><mi 
>g</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>0</mn>    </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left">  <mi 
>≈ù</mi> <mo 
class="MathClass-bin">‚àí</mo> <mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow>  </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >otherwise</mtext></mstyle><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--ll--></mtable>                                                           </mrow></mfenced>
</mrow></math></div>
         <!--l. 101--><p class="nopar" >
         </p></li>
         <li 
  class="enumerate" id="x1-3026x3">Compute the prediction error:
<div class="math-display"><!--l. 104--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                        <mi 
>e</mi> <mo 
class="MathClass-rel">‚Üê</mo> <mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi> <mo 
class="MathClass-bin">‚àí</mo><mi 
>≈ù</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mstyle 
class="text"><mtext  >¬†mod¬†</mtext></mstyle><mi 
>Œ≤</mi><mo 
class="MathClass-punc">,</mo>
</mrow></math></div>
         <!--l. 106--><p class="nopar" >
         where <!--l. 107--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Œ≤</mi></math>
         is the number of bits/pixel. This produces a projection of the residues from the dynamic
         range <!--l. 109--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">‚àí</mo><mi 
>Œ±</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mo 
class="MathClass-punc">,</mo><mi 
>Œ±</mi> <mo 
class="MathClass-bin">‚àí</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
         to <!--l. 109--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">‚àí</mo><mi 
>Œ±</mi><mo 
class="MathClass-bin">‚àï</mo><mn>2</mn><mo 
class="MathClass-punc">,</mo><mi 
>Œ±</mi><mo 
class="MathClass-bin">‚àï</mo><mn>2</mn> <mo 
class="MathClass-bin">‚àí</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></math>,
         where <!--l. 110--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Œ±</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>Œ≤</mi></mrow></msup 
></math>
         is the size of the source alphabet.
         </p></li>
         <li 
  class="enumerate" id="x1-3028x4">ShuÔ¨Ñe the residues in order to get an exponiential (with negative
         exponent) distribution of the probability of the residues:
                                                                  

                                                                  
<div class="math-display"><!--l. 115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
<mi 
>M</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>e</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">‚Üê</mo> <mfenced separators="" 
open="{"  close="" ><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="left"> <mn>2</mn><mi 
>e</mi>      </mtd><mtd 
class="array"  columnalign="left"> <mstyle 
class="text"><mtext  >if¬†</mtext></mstyle><mi 
>e</mi> <mo 
class="MathClass-rel">‚â•</mo> <mn>0</mn>     </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left">  <mn>2</mn><mo 
class="MathClass-rel">|</mo><mi 
>e</mi><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-bin">‚àí</mo> <mn>1</mn> </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >otherwise</mtext></mstyle><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--ll--></mtable>                                                               </mrow></mfenced>
</mrow></math></div>
         <!--l. 122--><p class="nopar" >
         After that, the residues are in the range
         <!--l. 123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-rel">‚ãØ</mo><mspace width="0.3em" class="thinspace"/><mo 
class="MathClass-punc">,</mo><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>Œ≤</mi></mrow></msup 
> <mo 
class="MathClass-bin">‚àí</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></math></p></li></ol>
     </li>
     <li 
  class="enumerate" id="x1-3030x4"><span 
class="ecbx-1000">Variable length encoding of </span><!--l. 126--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>e</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
     <span 
class="ecbx-1000">in the context </span><!--l. 126--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Q</mi></math>:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-3032x1">Output <!--l. 128--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">‚Üê</mo></math>
         a Rice code for <!--l. 128--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>e</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
         using the slope <!--l. 129--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">‚åà</mo><mrow><msub><mrow 
><mo class="qopname">log</mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>A</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">‚åâ</mo></mrow></math>.</li></ol>
     </li>
     <li 
  class="enumerate" id="x1-3034x5"><span 
class="ecbx-1000">Update the context </span><!--l. 132--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Q</mi></math>:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-3036x1"><!--l. 134--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚Üê</mo> <mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mi 
>e</mi></math>.
         </li>
         <li 
  class="enumerate" id="x1-3038x2"><!--l. 135--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚Üê</mo> <mi 
>A</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">|</mo><mi 
>e</mi><mo 
class="MathClass-rel">|</mo></math>.
         </li>
         <li 
  class="enumerate" id="x1-3040x3">If <!--l. 136--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi mathvariant="sans-serif">RESET</mi></math>, then:
         (where <!--l. 137--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>6</mn><mn>4</mn> <mo 
class="MathClass-rel">‚â§</mo><mi mathvariant="sans-serif">RESET</mi> <mo 
class="MathClass-rel">‚â§</mo> <mn>2</mn><mn>5</mn><mn>6</mn></math>)
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-3042x1"><!--l. 139--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚Üê</mo> <mi 
>A</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-bin">‚àï</mo><mn>2</mn></math>.
             </li>
             <li 
  class="enumerate" id="x1-3044x2"><!--l. 140--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚Üê</mo> <mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-bin">‚àï</mo><mn>2</mn></math>.
             </li>
             <li 
  class="enumerate" id="x1-3046x3"><!--l. 141--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚Üê</mo> <mi 
>N</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-bin">‚àï</mo><mn>2</mn></math>.</li></ol>
         </li>
         <li 
  class="enumerate" id="x1-3048x4"><!--l. 143--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚Üê</mo> <mi 
>N</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>.
                                                                  

                                                                  
         </li>
         <li 
  class="enumerate" id="x1-3050x5"><span 
class="ecbx-1000">Update of </span><!--l. 144--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>:
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-3052x1">If <!--l. 146--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚â§</mo><mo 
class="MathClass-bin">‚àí</mo><mi 
>N</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>,
             then:
                <ol  class="enumerate4" >
                <li 
  class="enumerate" id="x1-3054x1"><!--l. 148--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚Üê</mo> <mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mi 
>N</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>.
                </li>
                <li 
  class="enumerate" id="x1-3056x2">If <!--l. 149--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">&#x003E;</mo> <mo 
class="MathClass-bin">‚àí</mo><mn>1</mn><mn>2</mn><mn>8</mn></math>,
                then:
                  <ul class="itemize1">
                  <li class="itemize"><!--l. 151--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚Üê</mo> <mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">‚àí</mo> <mn>1</mn></math>.</li></ul>
                </li>
                <li 
  class="enumerate" id="x1-3058x3">If <!--l. 153--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚â§</mo><mo 
class="MathClass-bin">‚àí</mo><mi 
>N</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>,
                then:
                  <ul class="itemize1">
                  <li class="itemize"><!--l. 155--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚Üê</mo><mo 
class="MathClass-bin">‚àí</mo><mi 
>N</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>.</li></ul>
                </li></ol>
             </li>
             <li 
  class="enumerate" id="x1-3060x2">Else:
                <ol  class="enumerate4" >
                <li 
  class="enumerate" id="x1-3062x1">If <!--l. 160--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>0</mn></math>,
                then:
                  <ul class="itemize1">
                  <li class="itemize"><!--l. 162--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚Üê</mo> <mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">‚àí</mo> <mi 
>N</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>.
                  </li>
                  <li class="itemize">If <!--l. 163--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">&#x003C;</mo> <mn>1</mn><mn>2</mn><mn>7</mn></math>,
                  then:
                    <ul class="itemize2">
                    <li class="itemize"><!--l. 165--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚Üê</mo> <mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>.</li></ul>
                  </li>
                  <li class="itemize">If <!--l. 167--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>0</mn></math>,
                  then:
                    <ul class="itemize2">
                    <li class="itemize"><!--l. 169--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">‚Üê</mo> <mn>0</mn></math>.</li></ul>
                  </li></ul>
                </li></ol>
             </li></ol>
         </li></ol>
     </li></ol>
                                                                  

                                                                  
<!--l. 177--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-40002"></a>Decoder</h3>
<!--l. 178--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-4002x1">Idem to Step 1 of the encoder.
     </li>
     <li 
  class="enumerate" id="x1-4004x2">Idem to Step 2 of the encoder.
     </li>
     <li 
  class="enumerate" id="x1-4006x3">Decode <!--l. 181--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>e</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-4008x4">Compute the initial prediction such as in Step 3.a of the encoder.
     </li>
     <li 
  class="enumerate" id="x1-4010x5">Add the bias to <!--l. 184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>≈ù</mi></math>:
<div class="math-display"><!--l. 185--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
<mi 
>≈ù</mi> <mo 
class="MathClass-rel">‚Üê</mo> <mfenced separators="" 
open="{"  close="" ><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="left"> <mi 
>≈ù</mi> <mo 
class="MathClass-bin">‚àí</mo> <mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if¬†</mtext></mstyle><msub><mrow 
><mi 
>g</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>0</mn>    </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left">  <mi 
>≈ù</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Q</mi></mrow><mo 
class="MathClass-close">]</mo></mrow>  </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >otherwise</mtext></mstyle><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--ll--></mtable>                                                           </mrow></mfenced>
</mrow></math></div>
     <!--l. 192--><p class="nopar" >
     </p></li>
     <li 
  class="enumerate" id="x1-4012x6">Recover the original Laplace distribution for the residues:
                                                                  

                                                                  
<div class="math-display"><!--l. 194--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
<mi 
>e</mi> <mo 
class="MathClass-rel">‚Üê</mo> <msup><mrow 
><mi 
>M</mi></mrow><mrow 
><mo 
class="MathClass-bin">‚àí</mo><mn>1</mn></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>M</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>e</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mfenced separators="" 
open="{"  close="" ><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="left">   <mo 
class="MathClass-bin">‚àí</mo> <mi 
>M</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>e</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-bin">‚àï</mo><mn>2</mn> <mo 
class="MathClass-bin">‚àí</mo> <mn>1</mn> </mtd><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >si¬†</mtext></mstyle><mi 
>M</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>e</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mstyle 
class="text"><mtext  >is¬†odd</mtext></mstyle>  </mtd></mtr><mtr><mtd 
class="array"  columnalign="left">  <mi 
>M</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>e</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-bin">‚àï</mo><mn>2</mn> </mtd> <mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >otherwise</mtext></mstyle> <mo 
class="MathClass-punc">.</mo></mtd>
</mtr><!--ll--></mtable>                                                                                        </mrow></mfenced>
</mrow></math></div>
     <!--l. 201--><p class="nopar" >
     </p></li>
     <li 
  class="enumerate" id="x1-4014x7"><!--l. 202--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-rel">‚Üê</mo> <mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>e</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>≈ù</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mstyle 
class="text"><mtext  >¬†mod¬†</mtext></mstyle><mi 
>Œ≤</mi></math>.
     </li>
     <li 
  class="enumerate" id="x1-4016x8">Update <!--l. 203--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Q</mi></math>
     as in Step 5 of the encoder.</li></ol>
<!--l. 206--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-50003"></a>The RLE mode</h3>
<!--l. 207--><p class="noindent" >LOCO-I uses a Rice encoder that can be very redundant if the probability
distributions are very narrow. To overcome this drawback, there is
a special encoding mode for this situation that is triggered when
<!--l. 210--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>b</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>d</mi></math>.
</p><!--l. 212--><p class="indent" >   The normal mode is re-started when if
<!--l. 212--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi><mo 
class="MathClass-rel">‚â†</mo><mi 
>a</mi></math> or the
end of a line has been reached.
</p><!--l. 215--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-60003"></a>Let&#x2019;s go to the lab!</h3>
     <ul class="itemize1">
     <li class="itemize">Download     the     LOCO-I     command     line     executables     from
     <a 
href="http://www.hpl.hp.com/loco/locodown.htm" class="url" ><span 
class="ectt-1000">http://www.hpl.hp.com/loco/locodown.htm</span></a>.
                                                                  

                                                                  
     </li>
     <li class="itemize">Fill the table:
                                                                  

                                                                  
     <div class="verbatim" id="verbatim-1">
     ¬†Codec¬†|¬†lena¬†boats¬†pepers¬†zelda¬†Average
     ¬†<br />-------+---------------------------------
     ¬†<br />LOCO-I¬†|
</div>
     <!--l. 225--><p class="nopar" ></p></li></ul>
<!--l. 1--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-70003"></a>References</h3>
<!--l. 1--><p class="noindent" >
</p>
    
</body> 
</html>
                                                                  


